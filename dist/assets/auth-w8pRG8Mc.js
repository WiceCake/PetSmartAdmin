import{d as J,u as K,r as d,c as O,a as n,i as U,e as R,w as s,g as o,f as l,l as I,j as Q,k as _,m as q,t as X}from"./vue-vendor-DBH4gaed.js";import{u as Y}from"./stores-BYixwwI5.js";import{A as Z}from"./components-CxTxZpxR.js";import{_ as ee}from"./admin-p6Pbvhvw.js";import"./services-B6m35qR1.js";import"./ui-vendor-D2Zhk6Dz.js";import"./supabase-vendor-CEZ1HC2p.js";const oe={class:"login-container"},te={class:"welcome-section text-center mb-8"},le={class:"logo-container mb-6"},ae={class:"form-group mb-4"},se={class:"form-group mb-4"},ne={class:"d-flex justify-space-between align-center mb-6"},re={class:"d-flex align-center"},ie={class:"form-group"},de=J({__name:"LoginView",setup(ce){const F=K(),i=Y(),k=d(),u=d(""),p=d(""),A=d(!1),b=d(!1),m=d(""),f=d(!1),g=d(""),w=d(""),x=d(""),V=[a=>!!a||"Email is required",a=>/.+@.+\..+/.test(a)||"Email must be valid"],P=[a=>!!a||"Password is required",a=>a.length>=6||"Password must be at least 6 characters"],B=O(()=>u.value&&p.value&&V.every(a=>a(u.value)===!0)&&P.every(a=>a(p.value)===!0)),N=async()=>{var a,e,v,y;if(console.log("Login attempt started for:",u.value),m.value="",w.value="",x.value="",!((a=k.value)!=null&&a.validate())){console.log("Form validation failed");return}try{console.log("Calling authStore.signIn...");const t=await i.signIn(u.value,p.value);if(console.log("SignIn result:",t),t!=null&&t.success){if(console.log("Login successful, verifying auth state..."),await new Promise(h=>setTimeout(h,100)),!i.isAuthenticated||!i.isAdmin){console.error("Auth state verification failed:",{isAuthenticated:i.isAuthenticated,isAdmin:i.isAdmin,user:(e=i.user)==null?void 0:e.email,adminUser:i.adminUser}),m.value="Authentication state error. Please try again.";return}console.log("Auth state verified, getting redirect URL");const c=i.getAndClearRedirectUrl();console.log("Redirecting to:",c),await F.replace(c)}else console.log("Login failed:",t==null?void 0:t.error),m.value=(t==null?void 0:t.error)||"Login failed. Please try again.",(v=t==null?void 0:t.error)!=null&&v.includes("email")?w.value="Invalid email address":(y=t==null?void 0:t.error)!=null&&y.includes("password")&&(x.value="Invalid password")}catch(t){console.error("Login error:",t),m.value=t.message||"Login failed. Please try again."}},E=async()=>{if(g.value)try{const a=await i.resetPassword(g.value);a!=null&&a.success&&(f.value=!1,g.value="")}catch(a){console.error("Password reset error:",a)}};return(a,e)=>{const v=n("v-text-field"),y=n("v-checkbox"),t=n("v-btn"),c=n("v-icon"),h=n("v-alert"),L=n("v-form"),C=n("v-card-text"),S=n("v-card"),j=n("v-col"),z=n("v-row"),M=n("v-container"),$=n("v-main"),D=n("v-card-title"),T=n("v-spacer"),W=n("v-card-actions"),G=n("v-dialog"),H=n("v-app");return R(),U(H,null,{default:s(()=>[o($,null,{default:s(()=>[l("div",oe,[e[15]||(e[15]=l("div",{class:"background-elements"},[l("div",{class:"bg-circle bg-circle-1"}),l("div",{class:"bg-circle bg-circle-2"}),l("div",{class:"bg-circle bg-circle-3"})],-1)),o(M,{fluid:"",class:"fill-height"},{default:s(()=>[o(z,{justify:"center",align:"center",class:"fill-height"},{default:s(()=>[o(j,{cols:"12",sm:"8",md:"6",lg:"5",xl:"4"},{default:s(()=>[l("div",te,[l("div",le,[o(Z,{context:"login",clickable:!1,"fallback-text":"PetSmart"})]),e[8]||(e[8]=l("h1",{class:"text-h3 font-weight-bold text-white mb-2"}," Welcome Back ",-1)),e[9]||(e[9]=l("p",{class:"text-h6 text-white-lighten-2 mb-0"}," Sign in to your admin dashboard ",-1))]),o(S,{class:"login-card",elevation:"24",rounded:"xl"},{default:s(()=>[o(C,{class:"pa-8"},{default:s(()=>[e[14]||(e[14]=l("div",{class:"text-center mb-6"},[l("h2",{class:"text-h5 font-weight-bold text-on-surface mb-2"}," Admin Login "),l("p",{class:"text-body-2 text-on-surface-variant"}," Enter your credentials to continue ")],-1)),o(L,{onSubmit:I(N,["prevent"]),ref_key:"form",ref:k},{default:s(()=>[l("div",ae,[e[10]||(e[10]=l("label",{class:"form-label"},"Email Address",-1)),o(v,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=r=>u.value=r),type:"email","prepend-inner-icon":"mdi-email-outline",variant:"outlined",density:"comfortable",rules:V,"error-messages":w.value,placeholder:"Enter your email",class:"modern-input","hide-details":"auto",required:""},null,8,["modelValue","error-messages"])]),l("div",se,[e[11]||(e[11]=l("label",{class:"form-label"},"Password",-1)),o(v,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=r=>p.value=r),type:b.value?"text":"password","prepend-inner-icon":"mdi-lock-outline","append-inner-icon":b.value?"mdi-eye-outline":"mdi-eye-off-outline","onClick:appendInner":e[2]||(e[2]=r=>b.value=!b.value),variant:"outlined",density:"comfortable",rules:P,"error-messages":x.value,placeholder:"Enter your password",class:"modern-input","hide-details":"auto",required:""},null,8,["modelValue","type","append-inner-icon","error-messages"])]),l("div",ne,[o(y,{modelValue:A.value,"onUpdate:modelValue":e[3]||(e[3]=r=>A.value=r),label:"Remember me",density:"compact",color:"primary","hide-details":"",class:"remember-checkbox"},null,8,["modelValue"]),o(t,{variant:"text",color:"primary",size:"small",class:"forgot-btn",onClick:e[4]||(e[4]=r=>f.value=!0)},{default:s(()=>e[12]||(e[12]=[_(" Forgot password? ")])),_:1,__:[12]})]),o(t,{type:"submit",color:"primary",size:"large",block:"",loading:q(i).loading,disabled:!B.value,class:"login-btn mb-4",rounded:"lg"},{default:s(()=>[o(c,{icon:"mdi-login",class:"me-2"}),e[13]||(e[13]=_(" Sign In to Dashboard "))]),_:1,__:[13]},8,["loading","disabled"]),m.value?(R(),U(h,{key:0,type:"error",variant:"tonal",rounded:"lg",class:"error-alert"},{default:s(()=>[o(c,{icon:"mdi-alert-circle",class:"me-2"}),_(" "+X(m.value),1)]),_:1})):Q("",!0)]),_:1},512)]),_:1,__:[14]})]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1}),o(G,{modelValue:f.value,"onUpdate:modelValue":e[7]||(e[7]=r=>f.value=r),"max-width":"500",persistent:""},{default:s(()=>[o(S,{rounded:"xl",class:"forgot-dialog"},{default:s(()=>[o(D,{class:"pa-6 pb-4"},{default:s(()=>[l("div",re,[o(c,{icon:"mdi-lock-reset",color:"primary",class:"me-3",size:"28"}),e[16]||(e[16]=l("div",null,[l("h3",{class:"text-h5 font-weight-bold"},"Reset Password"),l("p",{class:"text-body-2 text-on-surface-variant mb-0"}," Enter your email to receive reset instructions ")],-1))])]),_:1}),o(C,{class:"pa-6 pt-0"},{default:s(()=>[o(L,{onSubmit:I(E,["prevent"])},{default:s(()=>[l("div",ie,[e[17]||(e[17]=l("label",{class:"form-label"},"Email Address",-1)),o(v,{modelValue:g.value,"onUpdate:modelValue":e[5]||(e[5]=r=>g.value=r),type:"email","prepend-inner-icon":"mdi-email-outline",variant:"outlined",density:"comfortable",rules:V,placeholder:"Enter your email address",class:"modern-input","hide-details":"auto",required:""},null,8,["modelValue"])])]),_:1})]),_:1}),o(W,{class:"pa-6 pt-0"},{default:s(()=>[o(t,{variant:"outlined",color:"secondary",onClick:e[6]||(e[6]=r=>f.value=!1),class:"me-3",rounded:"lg"},{default:s(()=>e[18]||(e[18]=[_(" Cancel ")])),_:1,__:[18]}),o(T),o(t,{color:"primary",loading:q(i).loading,onClick:E,rounded:"lg"},{default:s(()=>[o(c,{icon:"mdi-send",class:"me-2"}),e[19]||(e[19]=_(" Send Reset Email "))]),_:1,__:[19]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),be=ee(de,[["__scopeId","data-v-33f5e611"]]);export{be as default};
//# sourceMappingURL=auth-w8pRG8Mc.js.map
