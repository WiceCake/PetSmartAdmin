import{d as Fe,u as Me,C as Ae,r as f,c as de,o as Pe,a as c,b as g,e as m,f as e,g as t,w as l,k as _,t as d,m as Ke,i as A,j as Ne,F as le,h as ae,x as Qe,p as ke,l as be,s as Xe,y as et}from"./vue-vendor-DBH4gaed.js";import{A as E}from"./services-B6m35qR1.js";import{U as Se,a as De,b as tt}from"./components-CxTxZpxR.js";import{d as st,f as $e}from"./ui-vendor-D2Zhk6Dz.js";import{_ as Te}from"./admin-p6Pbvhvw.js";const lt={class:"users-view"},at={class:"page-header"},ot={class:"header-content"},nt={class:"header-actions"},it={class:"d-flex align-center"},rt={class:"stats-icon-container me-3"},dt={class:"text-h5 font-weight-bold"},ut={class:"d-flex align-center"},ct={class:"stats-icon-container me-3"},vt={class:"text-h5 font-weight-bold"},mt={class:"d-flex align-center"},_t={class:"stats-icon-container me-3"},ft={class:"text-h5 font-weight-bold"},pt={class:"d-flex align-center"},bt={class:"stats-icon-container me-3"},gt={class:"text-h5 font-weight-bold"},yt={class:"d-flex align-center justify-space-between w-100"},xt={class:"d-flex align-center"},ht={class:"d-flex align-center gap-2"},wt={class:"table-wrapper"},kt={key:0},$t=["colspan"],Ut={key:1},Ct=["colspan"],Vt={class:"text-body-2 text-medium-emphasis"},zt=["onClick"],Ft={class:"user-info d-flex align-center"},Mt={class:"user-text-content"},At={class:"email-column"},Pt={class:"text-body-2"},Nt={class:"text-body-2"},St={class:"date-column"},Dt={class:"text-body-2 font-weight-medium"},Tt={class:"text-caption text-medium-emphasis"},Et={class:"actions-column"},Rt={class:"desktop-actions d-flex align-center gap-1"},Lt={class:"mobile-actions"},Ot={class:"custom-pagination-footer"},jt={class:"pagination-info"},It={class:"items-per-page-section"},Bt={class:"pagination-text"},Wt={class:"text-body-2"},Ht={class:"pagination-controls"},qt={class:"page-numbers"},Zt=Fe({__name:"UsersView",setup(Ee){const ge=Me(),R=Ae(),k=f([]),z=f(!1),L=f(!1),i=f(!1),U=f(null),C=f(""),I=f("created_at"),N=f("active"),B=f(""),p=f(1),S=f(10),D=f(0),H=f(!1),O=f(null),q=f(!1),P=f(null),K=f(!1),Q=f(!1),W=f(null),oe=f(!1),ye=de(()=>k.value.filter(o=>o.is_active!==!1).length),ue=de(()=>{const o=new Date,s=new Date(o.getFullYear(),o.getMonth(),1);return k.value.filter(v=>v.created_at?new Date(v.created_at)>=s:!1).length}),u=de(()=>{const o=new Date;return o.setDate(o.getDate()-7),k.value.filter(s=>s.updated_at?new Date(s.updated_at)>=o:!1).length});de(()=>C.value||I.value!=="created_at"||N.value!=="active"||B.value);const a=[{title:"User",key:"user",sortable:!1,width:"250px",minWidth:"200px"},{title:"Email",key:"email",sortable:!0,width:"220px",minWidth:"180px"},{title:"Phone",key:"phone",sortable:!1,width:"140px",minWidth:"120px"},{title:"Status",key:"status",sortable:!1,width:"120px",minWidth:"100px"},{title:"Created",key:"created_at",sortable:!0,width:"140px",minWidth:"120px"},{title:"Actions",key:"actions",sortable:!1,width:"120px",minWidth:"90px",align:"start"}],h=[{title:"Newest First",value:"created_at"},{title:"Name A-Z",value:"first_name"},{title:"Username A-Z",value:"username"}],y=[{title:"Active",value:"active"},{title:"Inactive",value:"inactive"},{title:"All Users",value:"all"}],ne=[{title:"Last 7 days",value:"7d"},{title:"Last 30 days",value:"30d"},{title:"Last 3 months",value:"3m"},{title:"This year",value:"1y"}],M=async()=>{z.value=!0,U.value=null,console.log("Loading users with params:",{page:p.value,itemsPerPage:S.value,search:C.value});try{const{data:o,error:s,count:v}=await E.getUsers(p.value,S.value,C.value);if(s)throw s;k.value=o||[],D.value=v||0,console.log("Users loaded:",{dataLength:(o==null?void 0:o.length)||0,totalCount:v||0,currentPage:p.value,sampleUser:(o==null?void 0:o[0])||null})}catch(o){console.error("Failed to load users:",o),U.value=o instanceof Error?o.message:"Failed to load users",k.value=[],D.value=0}finally{z.value=!1}},$=st(()=>{p.value=1,M()},500),ie=de(()=>Math.ceil(D.value/S.value)),X=o=>{o>=1&&o<=ie.value&&!z.value&&(console.log("Going to page:",o),p.value=o,M())},Z=o=>{console.log("Items per page changed:",o),S.value=o,p.value=1,M()},ce=()=>{if(D.value===0)return"0 of 0";const o=(p.value-1)*S.value+1,s=Math.min(p.value*S.value,D.value);return`${o}-${s} of ${D.value}`},j=()=>{const o=ie.value,s=p.value,v=2;if(o<=7)return Array.from({length:o},(T,x)=>x+1);let b=Math.max(1,s-v),F=Math.min(o,s+v);return s<=v+1&&(F=Math.min(o,2*v+2)),s>=o-v&&(b=Math.max(1,o-2*v-1)),Array.from({length:F-b+1},(T,x)=>b+x)},ee=(o,s)=>{o.target.closest(".actions-column")||console.log("Row clicked:",s.username)},G=o=>{var b,F;const s=((b=o.first_name)==null?void 0:b.trim())||"",v=((F=o.last_name)==null?void 0:F.trim())||"";return`${s} ${v}`.trim()||null},Y=o=>o?$e(new Date(o),"MMM dd, yyyy"):"N/A",te=o=>o?$e(new Date(o),"HH:mm"):"N/A",ve=o=>{ge.push(`/users/${o.id}`)},r=()=>{xe(),Xe(()=>{H.value=!0})},Ue=o=>{O.value=o,H.value=!0},Re=async o=>{L.value=!0,U.value=null;try{if(O.value){const s={first_name:o.first_name,last_name:o.last_name,username:o.username,mobile_number:o.mobile_number||null,bio:o.bio||null},v=await E.updateUser(O.value.id,s);if(v.error)throw v.error;R.success("User updated successfully")}else{const s=await E.createUser({email:o.email,password:o.password,first_name:o.first_name,last_name:o.last_name,username:o.username,mobile_number:o.mobile_number||void 0,bio:o.bio||void 0});if(s.error)throw s.error;R.success("User created successfully")}xe(),M()}catch(s){console.error("Failed to save user:",s),U.value=s instanceof Error?s.message:"Failed to save user",R.error(U.value)}finally{L.value=!1}},xe=()=>{H.value=!1,O.value=null,L.value=!1},Le=async o=>{if(W.value){oe.value=!0;try{const s=await E.resetUserPassword(W.value.id,o);if(s.error)throw s.error;R.success(`Password reset successfully for ${W.value.username}`),Q.value=!1,W.value=null}catch(s){console.error("Failed to reset password:",s);const v=s instanceof Error?s.message:"Failed to reset password";R.error(v)}finally{oe.value=!1}}},Ce=o=>{P.value=o,q.value=!0},Oe=async()=>{if(P.value){K.value=!0;try{const o=await E.deleteUser(P.value.id);if(o.error)throw o.error;const s=P.value.username||`${P.value.first_name} ${P.value.last_name}`.trim()||"User";R.success(`${s} has been deleted successfully`),q.value=!1,P.value=null,M()}catch(o){console.error("Failed to delete user:",o);const s=o instanceof Error?o.message:"Failed to delete user";R.error(s)}finally{K.value=!1}}},je=()=>{q.value=!1,P.value=null,K.value=!1},Ie=()=>{p.value=1,M()},Be=()=>{p.value=1,M()},We=()=>{p.value=1,M()},He=()=>{C.value="",I.value="created_at",N.value="active",B.value="",p.value=1,M()},qe=async()=>{i.value=!0;try{const{data:o,error:s}=await E.getUsers(1,1e3,C.value);if(s)throw s;if(!o||o.length===0)throw new Error("No users found to export");const v=["Name","Username","Email","Mobile Number","Profile Visibility","Registration Date","Last Updated","Total Pets","Total Orders","Total Appointments"],b=o.map(w=>{var J,re,se,_e,fe,pe;return[`"${w.first_name||""} ${w.last_name||""}".trim()`,`"${w.username||""}"`,`"${w.email||""}"`,`"${w.mobile_number||""}"`,w.profile_visibility?"Public":"Private",w.created_at?Y(w.created_at):"",w.updated_at?Y(w.updated_at):"",((re=(J=w.pets)==null?void 0:J[0])==null?void 0:re.count)||0,((_e=(se=w.orders)==null?void 0:se[0])==null?void 0:_e.count)||0,((pe=(fe=w.appointments)==null?void 0:fe[0])==null?void 0:pe.count)||0]}),F=[v.join(","),...b.map(w=>w.join(","))].join(`
`),T=new Blob([F],{type:"text/csv;charset=utf-8;"}),x=document.createElement("a"),me=URL.createObjectURL(T);x.setAttribute("href",me),x.setAttribute("download",`petsmart-users-${new Date().toISOString().split("T")[0]}.csv`),x.style.visibility="hidden",document.body.appendChild(x),x.click(),document.body.removeChild(x),console.log(`Successfully exported ${o.length} users`)}catch(o){console.error("Failed to export users:",o),U.value=o instanceof Error?o.message:"Failed to export users"}finally{i.value=!1}};return Pe(()=>{M()}),(o,s)=>{var ze;const v=c("v-btn"),b=c("v-icon"),F=c("v-card-text"),T=c("v-card"),x=c("v-col"),me=c("v-row"),w=c("v-text-field"),J=c("v-select"),re=c("v-progress-circular"),se=c("v-chip"),_e=c("v-card-title"),fe=c("v-alert"),pe=c("v-img"),Ze=c("v-avatar"),Ve=c("v-tooltip"),he=c("v-list-item-title"),we=c("v-list-item"),Ge=c("v-list"),Ye=c("v-menu"),Je=c("v-table");return m(),g("div",lt,[e("div",at,[e("div",ot,[s[14]||(s[14]=e("div",{class:"header-text"},[e("h1",{class:"page-title"},"User Management"),e("p",{class:"page-subtitle"},"Manage and monitor all registered users across the platform")],-1)),e("div",nt,[t(v,{color:"secondary",size:"large",variant:"outlined","prepend-icon":"mdi-download",loading:i.value,disabled:z.value||k.value.length===0,onClick:qe,class:"export-btn me-3"},{default:l(()=>[_(d(i.value?"Exporting...":"Export"),1)]),_:1},8,["loading","disabled"]),t(v,{color:"primary",size:"large",variant:"flat","prepend-icon":"mdi-account-plus",class:"add-user-btn",onClick:r},{default:l(()=>s[13]||(s[13]=[_(" Add New User ")])),_:1,__:[13]})])])]),t(me,{class:"stats-section mb-6"},{default:l(()=>[t(x,{cols:"12",sm:"6",md:"3"},{default:l(()=>[t(T,{rounded:"xl",class:"stats-card",elevation:"2"},{default:l(()=>[t(F,{class:"pa-4"},{default:l(()=>[e("div",it,[e("div",rt,[t(b,{icon:"mdi-account-group",size:"32",color:"primary"})]),e("div",null,[e("div",dt,d(D.value),1),s[15]||(s[15]=e("div",{class:"text-body-2 text-on-surface-variant"},"Total Users",-1))])])]),_:1})]),_:1})]),_:1}),t(x,{cols:"12",sm:"6",md:"3"},{default:l(()=>[t(T,{rounded:"xl",class:"stats-card",elevation:"2"},{default:l(()=>[t(F,{class:"pa-4"},{default:l(()=>[e("div",ut,[e("div",ct,[t(b,{icon:"mdi-account-check",size:"32",color:"success"})]),e("div",null,[e("div",vt,d(ye.value),1),s[16]||(s[16]=e("div",{class:"text-body-2 text-on-surface-variant"},"Active Users",-1))])])]),_:1})]),_:1})]),_:1}),t(x,{cols:"12",sm:"6",md:"3"},{default:l(()=>[t(T,{rounded:"xl",class:"stats-card",elevation:"2"},{default:l(()=>[t(F,{class:"pa-4"},{default:l(()=>[e("div",mt,[e("div",_t,[t(b,{icon:"mdi-account-plus",size:"32",color:"info"})]),e("div",null,[e("div",ft,d(ue.value),1),s[17]||(s[17]=e("div",{class:"text-body-2 text-on-surface-variant"},"New This Month",-1))])])]),_:1})]),_:1})]),_:1}),t(x,{cols:"12",sm:"6",md:"3"},{default:l(()=>[t(T,{rounded:"xl",class:"stats-card",elevation:"2"},{default:l(()=>[t(F,{class:"pa-4"},{default:l(()=>[e("div",pt,[e("div",bt,[t(b,{icon:"mdi-account-clock",size:"32",color:"warning"})]),e("div",null,[e("div",gt,d(u.value),1),s[18]||(s[18]=e("div",{class:"text-body-2 text-on-surface-variant"},"Recently Active",-1))])])]),_:1})]),_:1})]),_:1})]),_:1}),t(T,{rounded:"xl",class:"filters-card mb-6",elevation:"2"},{default:l(()=>[t(F,{class:"pa-6"},{default:l(()=>[s[21]||(s[21]=e("div",{class:"filters-header mb-4"},[e("h3",{class:"text-h6 font-weight-bold"},"Filter & Search Users"),e("p",{class:"text-body-2 text-medium-emphasis"},"Find users by name, email, or status")],-1)),t(me,null,{default:l(()=>[t(x,{cols:"12",md:"4"},{default:l(()=>[t(w,{modelValue:C.value,"onUpdate:modelValue":s[0]||(s[0]=n=>C.value=n),label:"Search users...",placeholder:"Search by name, username, or email...","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"comfortable",clearable:"",onInput:Ke($),class:"search-field"},null,8,["modelValue","onInput"])]),_:1}),t(x,{cols:"12",md:"2"},{default:l(()=>[t(J,{modelValue:N.value,"onUpdate:modelValue":[s[1]||(s[1]=n=>N.value=n),Ie],label:"Status",items:y,variant:"outlined",density:"comfortable",clearable:"",class:"filter-select"},null,8,["modelValue"])]),_:1}),t(x,{cols:"12",md:"2"},{default:l(()=>[t(J,{modelValue:I.value,"onUpdate:modelValue":[s[2]||(s[2]=n=>I.value=n),Be],label:"Sort By",items:h,variant:"outlined",density:"comfortable",class:"filter-select"},null,8,["modelValue"])]),_:1}),t(x,{cols:"12",md:"2"},{default:l(()=>[t(J,{modelValue:B.value,"onUpdate:modelValue":[s[3]||(s[3]=n=>B.value=n),We],label:"Date Range",items:ne,variant:"outlined",density:"comfortable",clearable:"",class:"filter-select"},null,8,["modelValue"])]),_:1}),t(x,{cols:"12",md:"2"},{default:l(()=>[t(v,{color:"primary",variant:"outlined",size:"large",block:"",onClick:He,class:"reset-btn"},{default:l(()=>[t(b,{start:""},{default:l(()=>s[19]||(s[19]=[_("mdi-refresh")])),_:1,__:[19]}),s[20]||(s[20]=_(" Reset "))]),_:1,__:[20]})]),_:1})]),_:1})]),_:1,__:[21]})]),_:1}),t(T,{class:"users-table-card",rounded:"xl"},{default:l(()=>[t(_e,{class:"pa-6 pb-4"},{default:l(()=>[e("div",yt,[e("div",xt,[t(b,{icon:"mdi-table",class:"me-2"}),s[22]||(s[22]=e("span",{class:"text-h6 font-weight-bold"},"Users Directory",-1))]),e("div",ht,[z.value?(m(),A(se,{key:0,color:"primary",variant:"tonal",size:"small"},{default:l(()=>[t(re,{size:"12",width:"2",indeterminate:"",class:"me-2"}),s[23]||(s[23]=_(" Loading... "))]),_:1,__:[23]})):(m(),A(se,{key:1,color:"success",variant:"tonal",size:"small"},{default:l(()=>[_(d(k.value.length)+" of "+d(D.value)+" users ",1)]),_:1}))])])]),_:1}),U.value?(m(),A(fe,{key:0,type:"error",variant:"tonal",class:"ma-4",closable:"","onClick:close":s[4]||(s[4]=n=>U.value=null)},{default:l(()=>[_(d(U.value),1)]),_:1})):Ne("",!0),e("div",wt,[t(Je,{class:"modern-custom-table",hover:""},{default:l(()=>[e("thead",null,[e("tr",null,[(m(),g(le,null,ae(a,n=>e("th",{key:n.key,style:Qe({width:n.width,minWidth:n.minWidth})},d(n.title),5)),64))])]),e("tbody",null,[z.value?(m(),g("tr",kt,[e("td",{colspan:a.length,class:"text-center py-8"},[t(re,{indeterminate:"",color:"primary",size:"40"}),s[24]||(s[24]=e("div",{class:"mt-2 text-body-2"},"Loading users...",-1))],8,$t)])):k.value.length===0?(m(),g("tr",Ut,[e("td",{colspan:a.length,class:"text-center py-8"},[t(b,{size:"48",color:"grey-lighten-2",class:"mb-2"},{default:l(()=>s[25]||(s[25]=[_("mdi-account-off")])),_:1,__:[25]}),s[26]||(s[26]=e("div",{class:"text-h6 mb-2"},"No users found",-1)),e("div",Vt,d(C.value?"Try adjusting your search terms":"Start by adding your first user"),1)],8,Ct)])):(m(!0),g(le,{key:2},ae(k.value,n=>(m(),g("tr",{key:n.id,class:"table-row",onClick:V=>ee(V,n)},[e("td",null,[e("div",Ft,[t(Ze,{size:"40",class:"me-3 flex-shrink-0"},{default:l(()=>[n.profile_pic?(m(),A(pe,{key:0,src:n.profile_pic,alt:G(n)||n.username},null,8,["src","alt"])):(m(),A(b,{key:1,icon:"mdi-account"}))]),_:2},1024),e("div",Mt,[t(Ve,{text:G(n)||"No name provided",location:"top",disabled:!G(n)||G(n).length<=20},{activator:l(({props:V})=>[e("div",ke({class:"user-name font-weight-medium text-body-1"},{ref_for:!0},V),d(G(n)||"No name provided"),17)]),_:2},1032,["text","disabled"]),t(Ve,{text:"@"+(n.username||"No username"),location:"bottom",disabled:!n.username||n.username.length<=15},{activator:l(({props:V})=>[e("div",ke({class:"user-username text-caption text-medium-emphasis"},{ref_for:!0},V)," @"+d(n.username||"No username"),17)]),_:2},1032,["text","disabled"])])])]),e("td",null,[e("div",At,[e("div",Pt,d(n.email||"No email"),1)])]),e("td",null,[e("div",Nt,d(n.mobile_number||"Not provided"),1)]),e("td",null,[t(se,{color:n.is_active!==!1?"success":"error",size:"small",variant:"tonal",class:"font-weight-medium"},{default:l(()=>[t(b,{icon:n.is_active!==!1?"mdi-check-circle":"mdi-close-circle",size:"16",class:"me-1"},null,8,["icon"]),_(" "+d(n.is_active!==!1?"Active":"Inactive"),1)]),_:2},1032,["color"])]),e("td",null,[e("div",St,[e("div",Dt,d(Y(n.created_at)),1),e("div",Tt,d(te(n.created_at)),1)])]),e("td",null,[e("div",Et,[e("div",Rt,[t(v,{icon:"mdi-eye",variant:"text",size:"small",color:"info",onClick:be(V=>ve(n),["stop"])},null,8,["onClick"]),t(v,{icon:"mdi-pencil",variant:"text",size:"small",color:"primary",onClick:be(V=>Ue(n),["stop"])},null,8,["onClick"]),t(v,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:be(V=>Ce(n),["stop"])},null,8,["onClick"])]),e("div",Lt,[t(Ye,null,{activator:l(({props:V})=>[t(v,ke({icon:"mdi-dots-vertical",variant:"text",size:"small"},{ref_for:!0},V,{onClick:s[5]||(s[5]=be(()=>{},["stop"]))}),null,16)]),default:l(()=>[t(Ge,null,{default:l(()=>[t(we,{onClick:V=>ve(n)},{prepend:l(()=>[t(b,null,{default:l(()=>s[27]||(s[27]=[_("mdi-eye")])),_:1,__:[27]})]),default:l(()=>[t(he,null,{default:l(()=>s[28]||(s[28]=[_("View")])),_:1,__:[28]})]),_:2},1032,["onClick"]),t(we,{onClick:V=>Ue(n)},{prepend:l(()=>[t(b,null,{default:l(()=>s[29]||(s[29]=[_("mdi-pencil")])),_:1,__:[29]})]),default:l(()=>[t(he,null,{default:l(()=>s[30]||(s[30]=[_("Edit")])),_:1,__:[30]})]),_:2},1032,["onClick"]),t(we,{onClick:V=>Ce(n)},{prepend:l(()=>[t(b,null,{default:l(()=>s[31]||(s[31]=[_("mdi-delete")])),_:1,__:[31]})]),default:l(()=>[t(he,null,{default:l(()=>s[32]||(s[32]=[_("Delete")])),_:1,__:[32]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)])])])],8,zt))),128))])]),_:1}),e("div",Ot,[e("div",jt,[e("div",It,[s[33]||(s[33]=e("span",{class:"text-body-2 me-2"},"Rows per page:",-1)),t(J,{modelValue:S.value,"onUpdate:modelValue":[s[6]||(s[6]=n=>S.value=n),Z],items:[5,10,25,50,100],variant:"outlined",density:"compact","hide-details":"",class:"items-per-page-select"},null,8,["modelValue"])]),e("div",Bt,[e("span",Wt,d(ce()),1)])]),e("div",Ht,[t(v,{icon:"mdi-chevron-left",variant:"text",size:"small",disabled:p.value<=1||z.value,onClick:s[7]||(s[7]=n=>X(p.value-1)),class:"pagination-btn"},null,8,["disabled"]),e("div",qt,[(m(!0),g(le,null,ae(j(),n=>(m(),A(v,{key:n,variant:n===p.value?"flat":"text",color:n===p.value?"primary":"default",size:"small",disabled:z.value,onClick:V=>X(n),class:"pagination-btn","min-width":"40"},{default:l(()=>[_(d(n),1)]),_:2},1032,["variant","color","disabled","onClick"]))),128))]),t(v,{icon:"mdi-chevron-right",variant:"text",size:"small",disabled:p.value>=ie.value||z.value,onClick:s[8]||(s[8]=n=>X(p.value+1)),class:"pagination-btn"},null,8,["disabled"])])])])]),_:1}),t(Se,{modelValue:H.value,"onUpdate:modelValue":s[9]||(s[9]=n=>H.value=n),user:O.value,loading:L.value,onSubmit:Re,onCancel:xe},null,8,["modelValue","user","loading"]),t(De,{modelValue:q.value,"onUpdate:modelValue":s[10]||(s[10]=n=>q.value=n),user:P.value,loading:K.value,"show-stats":!1,onConfirm:Oe,onCancel:je},null,8,["modelValue","user","loading"]),t(tt,{modelValue:Q.value,"onUpdate:modelValue":s[11]||(s[11]=n=>Q.value=n),"user-name":((ze=W.value)==null?void 0:ze.username)||"Unknown",loading:oe.value,onReset:Le,onCancel:s[12]||(s[12]=n=>{Q.value=!1,W.value=null})},null,8,["modelValue","user-name","loading"])])}}}),Gt=Te(Zt,[["__scopeId","data-v-9452707c"]]),Zs=Object.freeze(Object.defineProperty({__proto__:null,default:Gt},Symbol.toStringTag,{value:"Module"})),Yt={class:"modern-user-detail-view"},Jt={class:"page-header mb-8"},Kt={class:"d-flex align-center justify-space-between flex-wrap gap-4"},Qt={class:"d-flex align-center"},Xt={key:0,class:"d-flex align-center gap-3"},es={key:0,class:"loading-container"},ts={key:1,class:"error-container"},ss={class:"text-body-2 mb-4"},ls={class:"text-h5 font-weight-bold mb-2"},as={class:"text-body-1 text-on-surface-variant mb-2"},os={class:"text-body-2 text-on-surface-variant mb-4"},ns={class:"text-caption text-on-surface-variant"},is={class:"d-flex align-center"},rs={class:"contact-item mb-4"},ds={class:"text-body-1"},us={class:"contact-item mb-4"},cs={class:"text-body-1"},vs={class:"contact-item"},ms={class:"text-body-1"},_s={class:"d-flex align-center"},fs={class:"overview-content"},ps={class:"text-h4 font-weight-bold text-primary"},bs={class:"text-h4 font-weight-bold text-info"},gs={class:"text-h4 font-weight-bold text-warning"},ys={class:"pets-content"},xs={key:0},hs={class:"d-flex align-center"},ws={class:"text-h6 font-weight-bold"},ks={class:"text-body-2 text-on-surface-variant"},$s={key:1,class:"text-center py-8"},Us={class:"orders-content"},Cs={key:0},Vs={class:"d-flex align-center justify-space-between"},zs={class:"text-h6 font-weight-bold"},Fs={class:"text-body-2 text-on-surface-variant"},Ms={class:"text-end"},As={class:"text-h6 font-weight-bold"},Ps={key:1,class:"text-center py-8"},Ns={class:"appointments-content"},Ss={key:0},Ds={class:"d-flex align-center justify-space-between"},Ts={class:"text-h6 font-weight-bold"},Es={class:"text-body-2 text-on-surface-variant"},Rs={key:1,class:"text-center py-8"},Ls={key:3,class:"not-found-container"},Os=Fe({__name:"UserDetailView",setup(Ee){const ge=et(),R=Me(),k=Ae(),z=f(!0),L=f(null),i=f(null),U=f("overview"),C=f(!1),I=f(!1),N=f(!1),B=f(!1),p=f(!1),S=u=>u?"success":"default",D=u=>{switch(u==null?void 0:u.toLowerCase()){case"pending":return"warning";case"processing":return"info";case"shipped":return"primary";case"delivered":return"success";case"cancelled":return"error";default:return"grey"}},H=u=>{switch(u==null?void 0:u.toLowerCase()){case"confirmed":return"success";case"pending":return"warning";case"cancelled":return"error";case"completed":return"info";default:return"grey"}},O=u=>u?$e(new Date(u),"MMM dd, yyyy"):"N/A",q=()=>{i.value&&(C.value=!0)},P=()=>{C.value=!1},K=async u=>{if(i.value){I.value=!0;try{const{data:a,error:h}=await E.updateUser(i.value.id,{first_name:u.first_name,last_name:u.last_name,username:u.username,mobile_number:u.mobile_number||null,bio:u.bio||null});if(h)throw h;a&&(i.value={...i.value,...a}),k.success("User updated successfully!"),C.value=!1}catch(a){console.error("Failed to update user:",a);const h=a instanceof Error?a.message:"Failed to update user";k.error(h)}finally{I.value=!1}}},Q=async()=>{if(i.value){p.value=!0;try{const u=!i.value.profile_visibility,{error:a}=await E.updateUser(i.value.id,{profile_visibility:u});if(a)throw a;i.value.profile_visibility=u;const h=u?"public":"private";k.success(`User profile set to ${h}`)}catch(u){console.error("Failed to update user status:",u);const a=u instanceof Error?u.message:"Failed to update user status";k.error(a)}finally{p.value=!1}}},W=()=>{i.value&&(N.value=!0)},oe=()=>{N.value=!1},ye=async()=>{if(i.value){B.value=!0;try{const{error:u}=await E.deleteUser(i.value.id);if(u)throw u;k.success("User deleted successfully"),R.push("/users")}catch(u){console.error("Failed to delete user:",u);const a=u instanceof Error?u.message:"Failed to delete user";k.error(a)}finally{B.value=!1,N.value=!1}}},ue=async()=>{z.value=!0,L.value=null;try{const u=ge.params.id,{data:a,error:h}=await E.getUserById(u);if(h)throw h;if(!a)throw new Error("User not found");i.value=a}catch(u){console.error("Failed to load user:",u),L.value=u instanceof Error?u.message:"Failed to load user",i.value=null}finally{z.value=!1}};return Pe(()=>{ue()}),(u,a)=>{const h=c("v-btn"),y=c("v-icon"),ne=c("v-chip"),M=c("v-progress-circular"),$=c("v-card"),ie=c("v-img"),X=c("v-avatar"),Z=c("v-card-text"),ce=c("v-card-title"),j=c("v-col"),ee=c("v-tab"),G=c("v-tabs"),Y=c("v-row"),te=c("v-tabs-window-item"),ve=c("v-tabs-window");return m(),g("div",Yt,[e("div",Jt,[e("div",Kt,[e("div",Qt,[t(h,{icon:"mdi-arrow-left",variant:"text",color:"primary",class:"me-4",onClick:a[0]||(a[0]=r=>u.$router.go(-1))}),a[6]||(a[6]=e("div",null,[e("h1",{class:"text-h4 font-weight-bold mb-1"},"User Details"),e("p",{class:"text-subtitle-1 text-on-surface-variant mb-0"}," View and manage user information ")],-1))]),i.value?(m(),g("div",Xt,[t(ne,{color:S(i.value.profile_visibility),variant:"tonal",size:"large",class:"font-weight-medium"},{default:l(()=>[t(y,{icon:i.value.profile_visibility?"mdi-eye":"mdi-eye-off",size:"16",class:"me-2"},null,8,["icon"]),_(" "+d(i.value.profile_visibility?"Public Profile":"Private Profile"),1)]),_:1},8,["color"])])):Ne("",!0)])]),z.value?(m(),g("div",es,[t($,{class:"pa-8 text-center",rounded:"xl"},{default:l(()=>[t(M,{indeterminate:"",color:"primary",size:"64",class:"mb-4"}),a[7]||(a[7]=e("div",{class:"text-h6 mb-2"},"Loading user details...",-1)),a[8]||(a[8]=e("div",{class:"text-body-2 text-on-surface-variant"},"Please wait while we fetch the information",-1))]),_:1,__:[7,8]})])):L.value?(m(),g("div",ts,[t($,{class:"pa-8 text-center",rounded:"xl",color:"error",variant:"tonal"},{default:l(()=>[t(y,{icon:"mdi-alert-circle",size:"64",color:"error",class:"mb-4"}),a[10]||(a[10]=e("div",{class:"text-h6 mb-2"},"Error Loading User",-1)),e("div",ss,d(L.value),1),t(h,{color:"error",onClick:ue},{default:l(()=>a[9]||(a[9]=[_("Try Again")])),_:1,__:[9]})]),_:1,__:[10]})])):i.value?(m(),A(Y,{key:2,class:"user-content"},{default:l(()=>[t(j,{cols:"12",lg:"4"},{default:l(()=>[t($,{class:"profile-card mb-6",rounded:"xl"},{default:l(()=>[t(Z,{class:"pa-8 text-center"},{default:l(()=>[t(X,{size:"120",class:"mb-6 profile-avatar"},{default:l(()=>[i.value.profile_pic?(m(),A(ie,{key:0,src:i.value.profile_pic,alt:`${i.value.first_name} ${i.value.last_name}`},null,8,["src","alt"])):(m(),A(y,{key:1,size:"60",color:"primary"},{default:l(()=>a[11]||(a[11]=[_("mdi-account")])),_:1,__:[11]}))]),_:1}),e("div",ls,d(i.value.first_name)+" "+d(i.value.last_name),1),e("div",as," @"+d(i.value.username||"No username"),1),e("div",os,d(i.value.email),1),e("div",ns," Member since "+d(O(i.value.created_at)),1)]),_:1})]),_:1}),t($,{class:"contact-card mb-6",rounded:"xl"},{default:l(()=>[t(ce,{class:"pa-6 pb-4"},{default:l(()=>[e("div",is,[t(y,{icon:"mdi-card-account-details",class:"me-2"}),a[12]||(a[12]=e("span",{class:"text-h6 font-weight-bold"},"Contact Information",-1))])]),_:1}),t(Z,{class:"pa-6 pt-0"},{default:l(()=>[e("div",rs,[a[13]||(a[13]=e("div",{class:"text-subtitle-2 font-weight-bold mb-1"},"Email Address",-1)),e("div",ds,d(i.value.email||"Not provided"),1)]),e("div",us,[a[14]||(a[14]=e("div",{class:"text-subtitle-2 font-weight-bold mb-1"},"Mobile Number",-1)),e("div",cs,d(i.value.mobile_number||"Not provided"),1)]),e("div",vs,[a[15]||(a[15]=e("div",{class:"text-subtitle-2 font-weight-bold mb-1"},"Bio",-1)),e("div",ms,d(i.value.bio||"No bio provided"),1)])]),_:1})]),_:1}),t($,{class:"actions-card",rounded:"xl"},{default:l(()=>[t(ce,{class:"pa-6 pb-4"},{default:l(()=>[e("div",_s,[t(y,{icon:"mdi-cog",class:"me-2"}),a[16]||(a[16]=e("span",{class:"text-h6 font-weight-bold"},"Actions",-1))])]),_:1}),t(Z,{class:"pa-6 pt-0"},{default:l(()=>[t(h,{color:"primary",variant:"elevated",block:"",class:"mb-3","prepend-icon":"mdi-pencil",onClick:q},{default:l(()=>a[17]||(a[17]=[_(" Edit User ")])),_:1,__:[17]}),t(h,{color:i.value.profile_visibility?"warning":"success",variant:"outlined",block:"",class:"mb-3","prepend-icon":i.value.profile_visibility?"mdi-eye-off":"mdi-eye",loading:p.value,onClick:Q},{default:l(()=>[_(d(i.value.profile_visibility?"Make Private":"Make Public"),1)]),_:1},8,["color","prepend-icon","loading"]),t(h,{color:"error",variant:"outlined",block:"","prepend-icon":"mdi-delete",onClick:W},{default:l(()=>a[18]||(a[18]=[_(" Delete User ")])),_:1,__:[18]})]),_:1})]),_:1})]),_:1}),t(j,{cols:"12",lg:"8"},{default:l(()=>[t($,{class:"tabs-card",rounded:"xl"},{default:l(()=>[t(G,{modelValue:U.value,"onUpdate:modelValue":a[1]||(a[1]=r=>U.value=r),class:"modern-tabs",color:"primary","slider-color":"primary"},{default:l(()=>[t(ee,{value:"overview",class:"tab-item"},{default:l(()=>[t(y,{icon:"mdi-chart-box",class:"me-2"}),a[19]||(a[19]=_(" Overview "))]),_:1,__:[19]}),t(ee,{value:"pets",class:"tab-item"},{default:l(()=>{var r;return[t(y,{icon:"mdi-paw",class:"me-2"}),_(" Pets ("+d(((r=i.value.pets)==null?void 0:r.length)||0)+") ",1)]}),_:1}),t(ee,{value:"orders",class:"tab-item"},{default:l(()=>{var r;return[t(y,{icon:"mdi-shopping",class:"me-2"}),_(" Orders ("+d(((r=i.value.orders)==null?void 0:r.length)||0)+") ",1)]}),_:1}),t(ee,{value:"appointments",class:"tab-item"},{default:l(()=>{var r;return[t(y,{icon:"mdi-calendar",class:"me-2"}),_(" Appointments ("+d(((r=i.value.appointments)==null?void 0:r.length)||0)+") ",1)]}),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:U.value,"onUpdate:modelValue":a[2]||(a[2]=r=>U.value=r),class:"pa-6"},{default:l(()=>[t(te,{value:"overview"},{default:l(()=>[e("div",fs,[a[25]||(a[25]=e("h3",{class:"text-h6 font-weight-bold mb-4"},"Account Statistics",-1)),t(Y,null,{default:l(()=>[t(j,{cols:"6",md:"3"},{default:l(()=>[t($,{class:"stat-card text-center pa-4",rounded:"lg",variant:"tonal",color:"primary"},{default:l(()=>{var r;return[t(y,{icon:"mdi-shopping",size:"32",color:"primary",class:"mb-2"}),e("div",ps,d(((r=i.value.orders)==null?void 0:r.length)||0),1),a[20]||(a[20]=e("div",{class:"text-body-2 text-on-surface-variant"},"Total Orders",-1))]}),_:1,__:[20]})]),_:1}),t(j,{cols:"6",md:"3"},{default:l(()=>[t($,{class:"stat-card text-center pa-4",rounded:"lg",variant:"tonal",color:"success"},{default:l(()=>[t(y,{icon:"mdi-currency-usd",size:"32",color:"success",class:"mb-2"}),a[21]||(a[21]=e("div",{class:"text-h4 font-weight-bold text-success"},"$0",-1)),a[22]||(a[22]=e("div",{class:"text-body-2 text-on-surface-variant"},"Total Spent",-1))]),_:1,__:[21,22]})]),_:1}),t(j,{cols:"6",md:"3"},{default:l(()=>[t($,{class:"stat-card text-center pa-4",rounded:"lg",variant:"tonal",color:"info"},{default:l(()=>{var r;return[t(y,{icon:"mdi-paw",size:"32",color:"info",class:"mb-2"}),e("div",bs,d(((r=i.value.pets)==null?void 0:r.length)||0),1),a[23]||(a[23]=e("div",{class:"text-body-2 text-on-surface-variant"},"Registered Pets",-1))]}),_:1,__:[23]})]),_:1}),t(j,{cols:"6",md:"3"},{default:l(()=>[t($,{class:"stat-card text-center pa-4",rounded:"lg",variant:"tonal",color:"warning"},{default:l(()=>{var r;return[t(y,{icon:"mdi-calendar",size:"32",color:"warning",class:"mb-2"}),e("div",gs,d(((r=i.value.appointments)==null?void 0:r.length)||0),1),a[24]||(a[24]=e("div",{class:"text-body-2 text-on-surface-variant"},"Appointments",-1))]}),_:1,__:[24]})]),_:1})]),_:1})])]),_:1}),t(te,{value:"pets"},{default:l(()=>[e("div",ys,[a[29]||(a[29]=e("h3",{class:"text-h6 font-weight-bold mb-4"},"Registered Pets",-1)),i.value.pets&&i.value.pets.length>0?(m(),g("div",xs,[t(Y,null,{default:l(()=>[(m(!0),g(le,null,ae(i.value.pets,r=>(m(),A(j,{key:r.id,cols:"12",md:"6"},{default:l(()=>[t($,{class:"pet-card pa-4",rounded:"lg",variant:"outlined"},{default:l(()=>[e("div",hs,[t(X,{size:"48",class:"me-3"},{default:l(()=>[t(y,{color:"primary"},{default:l(()=>a[26]||(a[26]=[_("mdi-paw")])),_:1,__:[26]})]),_:1}),e("div",null,[e("div",ws,d(r.name),1),e("div",ks,d(r.type||"Unknown type"),1)])])]),_:2},1024)]),_:2},1024))),128))]),_:1})])):(m(),g("div",$s,[t(y,{icon:"mdi-paw",size:"64",color:"grey",class:"mb-4"}),a[27]||(a[27]=e("div",{class:"text-h6 mb-2"},"No pets registered",-1)),a[28]||(a[28]=e("div",{class:"text-body-2 text-on-surface-variant"},"This user hasn't registered any pets yet.",-1))]))])]),_:1}),t(te,{value:"orders"},{default:l(()=>[e("div",Us,[a[32]||(a[32]=e("h3",{class:"text-h6 font-weight-bold mb-4"},"Order History",-1)),i.value.orders&&i.value.orders.length>0?(m(),g("div",Cs,[(m(!0),g(le,null,ae(i.value.orders,r=>(m(),A($,{key:r.id,class:"order-card mb-3",rounded:"lg",variant:"outlined"},{default:l(()=>[t(Z,{class:"pa-4"},{default:l(()=>[e("div",Vs,[e("div",null,[e("div",zs,"Order #"+d(r.id),1),e("div",Fs,d(O(r.created_at)),1)]),e("div",Ms,[e("div",As,"$"+d(r.total_amount||"0.00"),1),t(ne,{color:D(r.status),size:"small",variant:"tonal"},{default:l(()=>[_(d(r.status),1)]),_:2},1032,["color"])])])]),_:2},1024)]),_:2},1024))),128))])):(m(),g("div",Ps,[t(y,{icon:"mdi-shopping",size:"64",color:"grey",class:"mb-4"}),a[30]||(a[30]=e("div",{class:"text-h6 mb-2"},"No orders found",-1)),a[31]||(a[31]=e("div",{class:"text-body-2 text-on-surface-variant"},"This user hasn't placed any orders yet.",-1))]))])]),_:1}),t(te,{value:"appointments"},{default:l(()=>[e("div",Ns,[a[35]||(a[35]=e("h3",{class:"text-h6 font-weight-bold mb-4"},"Appointment History",-1)),i.value.appointments&&i.value.appointments.length>0?(m(),g("div",Ss,[(m(!0),g(le,null,ae(i.value.appointments,r=>(m(),A($,{key:r.id,class:"appointment-card mb-3",rounded:"lg",variant:"outlined"},{default:l(()=>[t(Z,{class:"pa-4"},{default:l(()=>[e("div",Ds,[e("div",null,[e("div",Ts,d(r.service_type||"Appointment"),1),e("div",Es,d(O(r.appointment_date))+" at "+d(r.appointment_time),1)]),t(ne,{color:H(r.status),size:"small",variant:"tonal"},{default:l(()=>[_(d(r.status),1)]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024))),128))])):(m(),g("div",Rs,[t(y,{icon:"mdi-calendar",size:"64",color:"grey",class:"mb-4"}),a[33]||(a[33]=e("div",{class:"text-h6 mb-2"},"No appointments found",-1)),a[34]||(a[34]=e("div",{class:"text-body-2 text-on-surface-variant"},"This user hasn't scheduled any appointments yet.",-1))]))])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})):(m(),g("div",Ls,[t($,{class:"pa-8 text-center",rounded:"xl"},{default:l(()=>[t(y,{icon:"mdi-account-question",size:"64",color:"grey",class:"mb-4"}),a[37]||(a[37]=e("div",{class:"text-h6 mb-2"},"User not found",-1)),a[38]||(a[38]=e("div",{class:"text-body-2 text-on-surface-variant mb-4"},"The requested user could not be found",-1)),t(h,{color:"primary",onClick:a[3]||(a[3]=r=>u.$router.push("/users"))},{default:l(()=>a[36]||(a[36]=[_("Back to Users")])),_:1,__:[36]})]),_:1,__:[37,38]})])),t(Se,{modelValue:C.value,"onUpdate:modelValue":a[4]||(a[4]=r=>C.value=r),user:i.value,loading:I.value,onSubmit:K,onCancel:P},null,8,["modelValue","user","loading"]),t(De,{modelValue:N.value,"onUpdate:modelValue":a[5]||(a[5]=r=>N.value=r),user:i.value,loading:B.value,"show-stats":!0,onConfirm:ye,onCancel:oe},null,8,["modelValue","user","loading"])])}}}),js=Te(Os,[["__scopeId","data-v-114d79ce"]]),Gs=Object.freeze(Object.defineProperty({__proto__:null,default:js},Symbol.toStringTag,{value:"Module"}));export{Zs as U,Gs as a};
//# sourceMappingURL=users-CE28I-1F.js.map
