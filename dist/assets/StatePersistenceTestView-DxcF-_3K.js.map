{"version":3,"file":"StatePersistenceTestView-DxcF-_3K.js","sources":["../../src/composables/useComponentState.ts","../../src/views/StatePersistenceTestView.vue"],"sourcesContent":["import { ref, onActivated, onDeactivated, onMounted, onUnmounted } from 'vue'\n\nexport interface ComponentStateOptions {\n  key: string\n  persistInLocalStorage?: boolean\n  restoreOnActivated?: boolean\n  saveOnDeactivated?: boolean\n}\n\nexport function useComponentState<T = any>(\n  initialState: T,\n  options: ComponentStateOptions\n) {\n  const {\n    key,\n    persistInLocalStorage = true,\n    restoreOnActivated = true,\n    saveOnDeactivated = true\n  } = options\n\n  const state = ref<T>(initialState)\n  const isActive = ref(true)\n  const storageKey = `component-state-${key}`\n\n  // Load state from localStorage\n  const loadState = (): T | null => {\n    if (!persistInLocalStorage) return null\n\n    try {\n      const stored = localStorage.getItem(storageKey)\n      if (stored) {\n        return JSON.parse(stored)\n      }\n    } catch (error) {\n      console.warn(`Failed to load component state for ${key}:`, error)\n    }\n    return null\n  }\n\n  // Save state to localStorage\n  const saveState = () => {\n    if (!persistInLocalStorage) return\n\n    try {\n      localStorage.setItem(storageKey, JSON.stringify(state.value))\n    } catch (error) {\n      console.warn(`Failed to save component state for ${key}:`, error)\n    }\n  }\n\n  // Restore state\n  const restoreState = () => {\n    const savedState = loadState()\n    if (savedState !== null) {\n      state.value = savedState\n    }\n  }\n\n  // Clear stored state\n  const clearState = () => {\n    try {\n      localStorage.removeItem(storageKey)\n    } catch (error) {\n      console.warn(`Failed to clear component state for ${key}:`, error)\n    }\n  }\n\n  // Update state\n  const setState = (newState: T) => {\n    state.value = newState\n    if (persistInLocalStorage) {\n      saveState()\n    }\n  }\n\n  // Merge state (for object states)\n  const mergeState = (partialState: Partial<T>) => {\n    if (typeof state.value === 'object' && state.value !== null) {\n      state.value = { ...state.value, ...partialState }\n      if (persistInLocalStorage) {\n        saveState()\n      }\n    }\n  }\n\n  // Component lifecycle hooks for keep-alive components\n  onActivated(() => {\n    isActive.value = true\n    if (restoreOnActivated) {\n      restoreState()\n    }\n  })\n\n  onDeactivated(() => {\n    isActive.value = false\n    if (saveOnDeactivated) {\n      saveState()\n    }\n  })\n\n  // Regular component lifecycle hooks\n  onMounted(() => {\n    if (restoreOnActivated) {\n      restoreState()\n    }\n  })\n\n  onUnmounted(() => {\n    if (saveOnDeactivated) {\n      saveState()\n    }\n  })\n\n  return {\n    state,\n    isActive,\n    setState,\n    mergeState,\n    saveState,\n    restoreState,\n    clearState\n  }\n}\n","<template>\n  <v-container fluid>\n      <v-row>\n        <v-col cols=\"12\">\n          <h1 class=\"text-h4 mb-6\">State Persistence Test</h1>\n          <p class=\"text-subtitle-1 mb-6\">\n            This page demonstrates the state persistence features implemented in the admin dashboard.\n          </p>\n        </v-col>\n      </v-row>\n\n      <!-- Sidebar State Test -->\n      <v-row>\n        <v-col cols=\"12\" md=\"6\">\n          <v-card class=\"mb-4\">\n            <v-card-title>Sidebar State Persistence</v-card-title>\n            <v-card-text>\n              <div class=\"mb-4\">\n                <h4>Current Sidebar State:</h4>\n                <ul>\n                  <li>Drawer Open: {{ sidebarStore.drawer ? 'Yes' : 'No' }}</li>\n                  <li>Rail Mode: {{ sidebarStore.rail ? 'Yes' : 'No' }}</li>\n                  <li>Scroll Position: {{ sidebarStore.scrollPosition }}px</li>\n                  <li>Last Route: {{ sidebarStore.lastActiveRoute }}</li>\n                </ul>\n              </div>\n              \n              <div class=\"d-flex gap-2 flex-wrap\">\n                <v-btn \n                  @click=\"sidebarStore.toggleDrawer()\"\n                  color=\"primary\"\n                  variant=\"outlined\"\n                >\n                  Toggle Drawer\n                </v-btn>\n                <v-btn \n                  @click=\"sidebarStore.toggleRail()\"\n                  color=\"secondary\"\n                  variant=\"outlined\"\n                >\n                  Toggle Rail\n                </v-btn>\n                <v-btn \n                  @click=\"sidebarStore.reset()\"\n                  color=\"warning\"\n                  variant=\"outlined\"\n                >\n                  Reset State\n                </v-btn>\n              </div>\n            </v-card-text>\n          </v-card>\n        </v-col>\n\n        <!-- Component State Test -->\n        <v-col cols=\"12\" md=\"6\">\n          <v-card class=\"mb-4\">\n            <v-card-title>Component State Persistence</v-card-title>\n            <v-card-text>\n              <v-form>\n                <v-text-field\n                  v-model=\"componentState.state.testInput\"\n                  label=\"Test Input (persisted)\"\n                  hint=\"This value persists across navigation\"\n                  persistent-hint\n                  @input=\"updateComponentState\"\n                />\n                \n                <v-slider\n                  v-model=\"componentState.state.testSlider\"\n                  label=\"Test Slider (persisted)\"\n                  min=\"0\"\n                  max=\"100\"\n                  @update:model-value=\"updateComponentState\"\n                />\n                \n                <v-switch\n                  v-model=\"componentState.state.testSwitch\"\n                  label=\"Test Switch (persisted)\"\n                  @update:model-value=\"updateComponentState\"\n                />\n                \n                <v-select\n                  v-model=\"componentState.state.testSelect\"\n                  :items=\"selectItems\"\n                  label=\"Test Select (persisted)\"\n                  @update:model-value=\"updateComponentState\"\n                />\n              </v-form>\n              \n              <div class=\"mt-4\">\n                <v-btn \n                  @click=\"componentState.clearState()\"\n                  color=\"error\"\n                  variant=\"outlined\"\n                >\n                  Clear Component State\n                </v-btn>\n              </div>\n            </v-card-text>\n          </v-card>\n        </v-col>\n      </v-row>\n\n      <!-- Instructions -->\n      <v-row>\n        <v-col cols=\"12\">\n          <v-card>\n            <v-card-title>Testing Instructions</v-card-title>\n            <v-card-text>\n              <h4>To test state persistence:</h4>\n              <ol>\n                <li><strong>Sidebar State</strong>: Toggle sidebar settings, then navigate to another page and back</li>\n                <li><strong>Scroll Position</strong>: Scroll in the sidebar navigation, navigate away, and return</li>\n                <li><strong>Component State</strong>: Fill out the form above, navigate to another page, and return</li>\n                <li><strong>Browser Refresh</strong>: Refresh the page to test localStorage persistence</li>\n                <li><strong>Responsive Behavior</strong>: Resize the window to test responsive state handling</li>\n              </ol>\n              \n              <v-alert type=\"info\" class=\"mt-4\">\n                <strong>Expected Behavior</strong>: All states should be preserved across navigation and browser refreshes.\n                The sidebar should maintain its position, the form should retain its values, and the scroll position should be restored.\n              </v-alert>\n            </v-card-text>\n          </v-card>\n        </v-col>\n      </v-row>\n  </v-container>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref } from 'vue'\nimport { useSidebarStore } from '@/stores/sidebar'\nimport { useComponentState } from '@/composables/useComponentState'\n\n// Sidebar store for testing\nconst sidebarStore = useSidebarStore()\n\n// Component state for testing\ninterface TestState {\n  testInput: string\n  testSlider: number\n  testSwitch: boolean\n  testSelect: string\n}\n\nconst componentState = useComponentState<TestState>(\n  {\n    testInput: '',\n    testSlider: 50,\n    testSwitch: false,\n    testSelect: 'option1'\n  },\n  {\n    key: 'state-persistence-test',\n    persistInLocalStorage: true,\n    restoreOnActivated: true,\n    saveOnDeactivated: true\n  }\n)\n\nconst selectItems = [\n  { title: 'Option 1', value: 'option1' },\n  { title: 'Option 2', value: 'option2' },\n  { title: 'Option 3', value: 'option3' }\n]\n\nconst updateComponentState = () => {\n  componentState.saveState()\n}\n</script>\n\n<style scoped>\n.gap-2 {\n  gap: 8px;\n}\n</style>\n"],"names":["useComponentState","initialState","options","key","persistInLocalStorage","restoreOnActivated","saveOnDeactivated","state","ref","isActive","storageKey","loadState","stored","error","saveState","restoreState","savedState","clearState","setState","newState","mergeState","partialState","onActivated","onDeactivated","onMounted","onUnmounted","sidebarStore","useSidebarStore","componentState","selectItems","updateComponentState","_createBlock","_component_v_container","_createVNode","_component_v_row","_component_v_col","_cache","_createElementVNode","_component_v_card","_component_v_card_title","_component_v_card_text","_hoisted_1","_toDisplayString","_unref","_hoisted_2","_component_v_btn","$event","_component_v_form","_component_v_text_field","_component_v_slider","_component_v_switch","_component_v_select","_hoisted_3","_component_v_alert"],"mappings":"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"}